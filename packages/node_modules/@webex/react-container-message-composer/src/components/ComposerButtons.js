import React from 'react';
import PropTypes from 'prop-types';
import classNames from 'classnames';
import bowser from 'bowser';
import uuid from 'uuid';

import {Icon} from '@momentum-ui/react';

import styles from './ComposerButtons.css';

function ComposerButtons({onAttachFile, composerActions}) {
  const inputId = `messageFileInput-${uuid.v4()}`;

  function handleFileIconClick(event) {
    if (event.type === 'click' || event.type === 'keydown' && (event.keyCode === 13 || event.keyCode === 32)) {
      if (!bowser.safari) {
        document.getElementById(inputId).click();
      }
    }
  }

  return (
    (
      composerActions.attachFiles &&
      <div className={classNames('webex-message-composer-buttons', styles.buttonsArea)}>
        <label htmlFor={inputId}>
          <Icon
            ariaLabel="Attach Files"
            name="attachment_16"
            onClick={handleFileIconClick}
          />
          <input
            className={classNames('webex-file-input', styles.fileInput)}
            id={inputId}
            multiple="multiple"
            onChange={onAttachFile}
            type="file"
          />
        </label>
      </div>
    ) || null
  );
}

ComposerButtons.propTypes = {
  onAttachFile: PropTypes.func
};

ComposerButtons.defaultProps = {
  onAttachFile: () => {}
};

export default ComposerButtons;
